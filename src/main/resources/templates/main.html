<!DOCTYPE html>
<html>
<head>
    <title>경기대 밥맛</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <style>
        .customoverlay {position:relative;right:2px;bottom:80px;border-radius:6px;border: 1px solid #ccc;border-bottom:2px solid #ddd;float:left;}
        .customoverlay:nth-of-type(n) {border:0; box-shadow:0px 1px 2px #888;}
        .customoverlay a {display:block;text-decoration:none;color:#000;text-align:center;border-radius:6px;font-size:14px;font-weight:bold;overflow:hidden;}
        .customoverlay .title {display:block;text-align:center;background:#fff;padding:10px 15px;font-size:14px;font-weight:bold;}
    </style>
</head>
<body>
    <h1>This is 'main.html'</h1><br>
    <a href="/selectStore">selectStore.html</a><br>
    <a href="/store">store.html</a><br>
    <a href="/todayFood">todayFood.html</a><br>
    <a href="/myPage">myPage.html</a><br>
    <a href="/writeReview">writeReview.html</a><br>

    <br>
    <div id="map" style="width:600px; height:500px;"></div>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f333805471087979c44ca72e4b0e9428"></script>
    <script>
        const container = document.getElementById('map'); // 지도를 담을 영역
        let options = { // 지도를 생성할 때 필요한 기본 옵션
            center: new kakao.maps.LatLng(37.3014, 127.0373), // 지도의 중심좌표
            level: 4 // 지도의 레벨(확대, 축소 정도)
        };
        let map = new kakao.maps.Map(container, options); // 지도 생성 및 객체 리턴

        var imageSrc = 'https://user-images.githubusercontent.com/90389517/212600851-24700888-5f81-40fe-81e7-db62bbf5a7bc.png', // 마커이미지의 주소
            imageSize = new kakao.maps.Size(60, 60), // 마커이미지의 크기
            imageOption = {offset: new kakao.maps.Point(32, 69)}; // 마커이미지의 옵션. 마커의 좌표와 일치시킬 이미지 안에서의 좌표 설정.

        // 마커의 이미지정보를 가지고 있는 마커이미지 생성
        var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption);

        var positions = [
            {
                title: '경슐랭',
                latlng: new kakao.maps.LatLng(37.30318, 127.0359)
            },
            {
                title: '이스퀘어 식당',
                latlng: new kakao.maps.LatLng(37.30053, 127.03715)
            },
            {
                title: '감성코어',
                latlng: new kakao.maps.LatLng(37.30115, 127.03613)
            },
            {
                title: '기숙사 식당',
                latlng: new kakao.maps.LatLng(37.29775, 127.03852)
            },
            {
                title: '플랜비',
                latlng: new kakao.maps.LatLng(37.3019, 127.03665)
            }
        ];

        for (let i = 0; i < positions.length; i ++) {
            var marker = new kakao.maps.Marker({
                map: map,
                title: positions[i].title,
                position: positions[i].latlng,
                image : markerImage
            });

            var customOverlay = new kakao.maps.CustomOverlay({
                map: map,
                position: positions[i].latlng,
                content: makeContent(positions[i].title),
                yAnchor: 1
            });

            customOverlay.setMap(null);

            // kakao.maps.event.addListener(marker, 'click', function () {
            //     window.open('/store?storeName=' + marker[i].title);
            // });

            kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, customOverlay));
            kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(customOverlay));
        }

        function makeContent(storeName) {
            return '<div class="customoverlay">' +
                '  <a href="/store" target="_blank">' +
                '    <span class="title">' + storeName + '</span>' +
                '  </a>' +
                '</div>'
        }

        function makeOverListener(map, marker, customOverlay) {
            return function() {
                customOverlay.setMap(map);
            };
        }

        function makeOutListener(customOverlay) {
            return function() {
                customOverlay.setMap(null)
            };
        }
    </script>
</body>
</html>