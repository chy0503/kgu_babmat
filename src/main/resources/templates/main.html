<!DOCTYPE html>
<html>
<head>
    <title>경기대 밥맛</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.bundle.min.js"></script>
</head>
<body>
<div class="container">
    <!-- 페이지 로고 및 이름 -->
    <div class="d-flex justify-content-center my-5">
        <h1>경기대 밥맛</h1>
    </div>

    <header class="py-3 mb-3 border-bottom">
        <div class="d-flex flex-row justify-content-between">
            <form class="col-5" role="search">
                <input type="search" class="form-control noOutline" style="height: 50px;" placeholder="Search...">
            </form>

            <div class="row">
                <h3 class="mr-3 align-self-center">username</h3>
                <div class="dropdown mr-4">
                    <div class="d-block link-dark text-decoration-none dropdown-toggle" data-toggle="dropdown"
                         aria-haspopup="true" aria-expanded="false">
                        <img src="https://user-images.githubusercontent.com/90389517/212916931-321ab7a7-7f29-4c6d-acf7-3c7620f9ed09.jpeg"
                             width="50" height="50" class="rounded-circle">
                    </div>
                    <ul class="shadow dropdown-menu dropdown-menu-right mt-2">
                        <li><a class="dropdown-item" href="/myPage">마이페이지</a></li>
                        <li><a class="dropdown-item" href="/writeReview">리뷰 작성하기</a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="#">로그아웃</a></li>
                    </ul>
                </div>
            </div>

        </div>
    </header>

    <!-- 인기 순위 섹션 -->
    <div class="my-5 bg-f0 rounded-10" style="width:100%; height:200px;">인기 순위 섹션</div>


    <!-- 지도와 식당 버튼 리스트 -->
    <!-- 버튼 리스트: 식당 페이지 연결 -->
    <div class="row">
        <div class="col-8">
            <div id="map" class="rounded-10" style="height:430px;"></div>
        </div>
        <script type="text/javascript"
                src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f333805471087979c44ca72e4b0e9428"></script>
<!--        <script type="text/javascript" src="js/kakaoMap.js"></script>-->
        <script>
            const container = document.getElementById('map'); // 지도를 담을 영역
            let options = { // 지도를 생성할 때 필요한 기본 옵션
                center: new kakao.maps.LatLng(37.3014, 127.0373), // 지도의 중심좌표
                level: 4 // 지도의 레벨(확대, 축소 정도)
            };
            let map = new kakao.maps.Map(container, options); // 지도 생성 및 객체 리턴

            var imageSrc = 'https://user-images.githubusercontent.com/90389517/212600851-24700888-5f81-40fe-81e7-db62bbf5a7bc.png', // 마커이미지의 주소
                imageSize = new kakao.maps.Size(60, 60), // 마커이미지의 크기
                imageOption = {offset: new kakao.maps.Point(32, 69)}; // 마커이미지의 옵션. 마커의 좌표와 일치시킬 이미지 안에서의 좌표 설정.

            var biggerImageSize = new kakao.maps.Size(65, 65), // 마커이미지의 크기
                biggerImageOption = {offset: new kakao.maps.Point(34, 74)};


            // 마커의 이미지정보를 가지고 있는 마커이미지 생성
            var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption);
            var biggerMarkerImage = new kakao.maps.MarkerImage(imageSrc, biggerImageSize, biggerImageOption);

            var positions = [
                {
                    latlng: new kakao.maps.LatLng(37.30318, 127.0359)
                },
                {
                    latlng: new kakao.maps.LatLng(37.30053, 127.03715)
                },
                {
                    latlng: new kakao.maps.LatLng(37.30115, 127.03613)
                },
                {
                    latlng: new kakao.maps.LatLng(37.29775, 127.03852)
                },
                {
                    latlng: new kakao.maps.LatLng(37.3019, 127.03665)
                }
            ];

            var storeNames = ['경슐랭', '이스퀘어 식당', '감성코어', '기숙사 식당', '플랜비'];

            for (let i = 0; i < positions.length; i ++) {
                var marker = new kakao.maps.Marker({
                    map: map,
                    title: storeNames[i],
                    position: positions[i].latlng,
                    image : markerImage
                });

                var customOverlay = new kakao.maps.CustomOverlay({
                    map: map,
                    position: positions[i].latlng,
                    content: makeContent(storeNames[i]),
                    yAnchor: 1
                });

                customOverlay.setMap(null);

                kakao.maps.event.addListener(marker, 'click', function () {
                    window.open('/store?storeName=' + storeNames[i]);
                });

                kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, customOverlay));
                kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(map, marker, customOverlay));
            }

            function makeContent(storeName) {
                return '<div class="customoverlay">' +
                    '  <a href="/store" target="_self">' +
                    '    <span class="title">' + storeName + '</span>' +
                    '  </a>' +
                    '</div>'
            }

            function makeOverListener(map, marker, customOverlay) {
                return function() {
                    marker.setImage(biggerMarkerImage);
                    customOverlay.setMap(map);
                };
            }

            function makeOutListener(map, marker, customOverlay) {
                return function() {
                    marker.setImage(markerImage);
                    customOverlay.setMap(null)
                };
            }
        </script>

        <div class="col-4 storeList">
            <ul class="list-group" style="height: 430px;">
                <th:block th:each="list : ${storeList}">
                    <button th:onclick="|location.href='@{/store(storeName=${list.name})}'|"
                            class="noOutline list-group-item p-4 text-center">
                        <div th:text="${list.name}" class="storeName"></div>
                    </button>
                </th:block>
            </ul>
        </div>
    </div>

    <div class="rounded-10 bg-f0 my-5" style="height: 200px">
        <a href="/todayFood">오늘 뭐 먹지?</a>
    </div>
</div>

</body>
</html>